(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{19:function(e,t,n){},26:function(e,t,n){e.exports=n(55)},31:function(e,t,n){},33:function(e,t,n){},35:function(e,t,n){},37:function(e,t,n){},40:function(e,t,n){},42:function(e,t,n){},50:function(e,t,n){},52:function(e,t,n){},55:function(e,t,n){"use strict";n.r(t);var a,o,r=n(0),c=n.n(r),s=n(20),l=n.n(s),i=(n(31),n(7)),u=n(8),p=n(10),d=n(9),m=n(11),f=n(6),E=n.n(f),h=(n(33),function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(p.a)(this,Object(d.a)(t).call(this,e))).handleMidiConnectEvent=function(e){console.log("handleMidiConnectEvent: ".concat(e.port.type," ").concat(e.type,": ").concat(e.port.name),e),"input"===e.port.type&&(console.log("call onInputChange"),n.onInputChange()),"output"===e.port.type&&(console.log("call onOutputChange"),n.onOutputChange())},n.midiOn=function(e){e?console.warn("WebMidi could not be enabled.",e):(console.log("WebMidi enabled!"),f.addListener("connected",n.handleMidiConnectEvent),f.addListener("disconnected",n.handleMidiConnectEvent))},n.onInputChange=e.onInputChange,n.onOutputChange=e.onOutputChange,n}return Object(m.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){f.enable(this.midiOn,!0),console.warn("Midi.componentDidUnmount")}},{key:"componentWillUnmount",value:function(){console.warn("Midi.componentWillUnmount")}},{key:"render",value:function(){return null}}]),t}(r.Component)),v=n(59),b=n(57),g=n(58),y=n(60),O=(n(35),n(2)),C=[0,1,119],j=[127];function N(e){return 128-Uint8Array.from(e).reduce(function(e,t){return e+t})%128}function P(e,t){var n=[2,1,e,t],a=N(n);return n.push(a),j.concat(n)}var S=function(e){if(0===e)return"CUR";var t=Math.floor((e-1)/6),n=(e-1)%6+1;return String.fromCharCode(t+65)+n.toString()},k=(a={},Object(O.a)(a,1,"preset"),Object(O.a)(a,5,"global"),Object(O.a)(a,7,"full backup"),a),I={1:"name",13:"1",14:"2",15:"3",16:"4",17:"5",18:"6",19:"RESERVED",20:"A",21:"B",22:"C",23:"D",24:"FS 1",25:"FS 2",26:"FS 3",27:"FS 4",54:"EXP 1",55:"EXP 2",126:"MIDI configuration",127:"ALL"},w=[20,21,22,23],M=[13,14,15,16,17,18],x=[24,25,26,27],A=[54,55],T=(o={},Object(O.a)(o,0,"CC"),Object(O.a)(o,3,"NRPN C"),Object(O.a)(o,4,"NRPN F"),Object(O.a)(o,1,"PITCH"),Object(O.a)(o,2,"AT CHAN"),Object(O.a)(o,126,"DAW FUNC"),Object(O.a)(o,97,"CTRL_OFF"),Object(O.a)(o,71,"CC TOGGLE"),Object(O.a)(o,64,"CC"),Object(O.a)(o,72,"CC STEP"),Object(O.a)(o,67,"NOTE"),Object(O.a)(o,68,"NOTE TOGGLE"),Object(O.a)(o,69,"PRG BANK"),Object(O.a)(o,70,"PRG STEP"),Object(O.a)(o,87,"NRPN COARSE"),Object(O.a)(o,88,"NRPN FINE"),Object(O.a)(o,85,"MMC"),Object(O.a)(o,89,"RELAY"),Object(O.a)(o,98,"PRESET SELECT"),Object(O.a)(o,86,"PRESET INC DEC"),Object(O.a)(o,99,"STEP SELECT"),Object(O.a)(o,100,"STEP INC DEC"),Object(O.a)(o,18,"CC"),Object(O.a)(o,17,"CC REL"),Object(O.a)(o,21,"NRPN C"),Object(O.a)(o,22,"NRPN F"),Object(O.a)(o,19,"PITCH"),Object(O.a)(o,20,"AT CHAN"),Object(O.a)(o,16,"PRG"),Object(O.a)(o,23,"PRESET SEL"),Object(O.a)(o,24,"STEP SEL"),Object(O.a)(o,101,"CC"),o),D=function(e){var t=e.name,n=e.id,a=e.selected,o=e.onClick;return c.a.createElement("div",{className:a?"selected":"",onClick:function(){return o(n)}},t)},R=function(e){var t=e.currentPreset,n=e.onClick;return c.a.createElement("div",{className:"selectors"},["A","B","C","D"].map(function(e){return c.a.createElement("div",{key:e},Array.from(Array(6).keys()).map(function(a){var o,r=e+(a+1),s="CUR"===(o=r)?0:6*(o.charCodeAt(0)-65)+parseInt(o[1],10);return c.a.createElement(D,{name:r,id:s,selected:s===t,onClick:n,key:s})}))}))},L=(n(37),n(21)),B=n.n(L);function U(e){return E.a.inputs.find(function(t){return t.id===e})}function F(e){return E.a.outputs.find(function(t){return t.id===e})}var W=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(p.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(o)))).state={input:null,output:null},n.connectInput=function(e){var t=U(e);t?t.addListener("sysex","all",n.props.onMidiEvent):console.log("connectInput: input ".concat(e," not found"))},n.disconnectInput=function(e){var t=U(e);t?t.removeListener():console.log("disconnectInput: input ".concat(e," not found"))},n.togglePort=function(e){if("input"===function(e){var t=E.a.inputs.find(function(t){return t.id===e});return t||E.a.outputs.find(function(t){return t.id===e})}(e).type){var t=n.state.input;n.state.input&&(n.disconnectInput(n.state.input),n.setState({input:null})),e!==t&&(n.connectInput(e),n.setState({input:e}))}else{var a=n.state.output;n.state.output&&(n.props.onPortSelection(null),n.setState({output:null})),e!==a&&(n.props.onPortSelection(e),n.setState({output:e}))}},n.isPacer=function(e){return"nektar"===e.manufacturer.toLowerCase()&&"PACER MIDI1"===e.name.toUpperCase()},n}return Object(m.a)(t,e),Object(u.a)(t,[{key:"componentWillUnmount",value:function(){console.log("MidiPorts.componentWillUnmount",this.state),this.state.input&&this.disconnectInput(this.state.input)}},{key:"render",value:function(){var e=this;console.log("MidiPorts render",this.props.type,this.props.ports);var t=this.props.ports&&this.props.ports.filter(function(t){return e.isPacer(t)});return console.log("MidiPorts render pacer ports",t),t&&t.length>0?c.a.createElement("div",{id:"ports"},t.map(function(t){var n="input"===t.type?e.state.input===t.id:e.state.output===t.id;return c.a.createElement("div",{key:t.id,className:n?"port ".concat(t.type," enabled"):"port ".concat(t.type)},c.a.createElement("div",{className:"port-description"},c.a.createElement("div",{className:"type"},t.type," ","input"===t.type?"from":"to"),c.a.createElement("div",{className:"port-name"},t.name)),c.a.createElement("div",{className:"port-state"},c.a.createElement(B.a,{onChange:function(){return e.togglePort(t.id)},checked:n,className:"react-switch",id:"normal-switch",height:20,width:42}),c.a.createElement("span",{className:n?"port-usage selected":"port-usage",onClick:function(){return e.togglePort(t.id)}},n?"enabled":"disabled")))})):c.a.createElement("div",{className:"warning"},"No Pacer ",this.props.type," port found.")}}]),t}(r.Component),_=n(16),G=function(e,t,n){for(var a="",o=n||"0",r=(t||2)-e.length;a.length<r;)a+=o;return a+e},H=function(e){return G(e.toString(16).toUpperCase(),2)},z=function(e){return e?Array.from(e).map(function(e){return H(e)}).join(" "):""},J=240,K=247,X=4,Y=5,q=6,V=7,$=8;function Q(e){return e&&"object"===typeof e&&!Array.isArray(e)}function Z(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];if(!n.length)return e;var o=n.shift();if(Q(e)&&Q(o))for(var r in o)Q(o[r])?(e[r]||Object.assign(e,Object(O.a)({},r,{})),Z(e[r],o[r])):Object.assign(e,Object(O.a)({},r,o[r]));return Z.apply(void 0,[e].concat(n))}function ee(e){var t=new Uint8Array(e);return t[0]===J&&t[t.byteLength-1]===K}function te(e){var t,n={},a=e[X],o=e[Y],r=e[q],c=e[V];switch(a){case 1:case 2:break;default:return console.warn("invalid command (".concat(H(a),")")),null}if(!(o in k))return console.warn("invalid target",H(o),o,k),null;if(n[o]={},r>=25&&r<=126&&console.warn("invalid/ignored idx",r),n[o][r]={},!(c in I))return console.warn("invalid/ignored object",H(c)),null;if(1===c)t="name";else if(c>=13&&c<=18||c>=20&&c<=27||c>=54&&c<=55)t="control";else{if(126!==c)return console.warn("invalid obj",c),null;t="midi"}if(console.log("".concat(k[o]," ").concat(H(r)," : ").concat(I[c]," ").concat(t)),"control"===t){n[o][r].controls=Object(O.a)({},c,{steps:{}});var s=e[$];if(s>=1&&s<=36)if(e.length>$+22){var l=function(e){return{index:(e[0]-1)/6+1,config:{channel:e[2],msg_type:e[6],data:[e[10],e[14],e[18]],active:e[22]}}}(e.slice($,$+23));n[o][r].controls[c].steps[l.index]=l.config}else console.warn("data does not contains steps. data.length=".concat(e.length),z(e));else if(96===s)console.log("CONTROL MODE");else if(64===s)console.log("LED MIDI CTRL");else if(s>=65&&s<=67)console.error("LED"),n[o][r].controls[c].led=function(e){return{midi:e[2],on_color:e[6],off_color:e[10]}}(e.slice($,$+3));else{if(127!==s)return console.warn("unknown element: ".concat(H(s))),null;console.log("ALL")}}return n}function ne(e){if(console.log("parseSysexData"),null===e)return null;for(var t=new Uint8Array(e),n={},a=0;!((a=t.indexOf(J,a))<0);){a++;var o=t.indexOf(K,a);if(Array.from(t.slice(a,a+3)).map(function(e){return H(e)}).join(" ")!==_.NEKTAR_TECHNOLOGY_INC)return console.log("file does not contain a Nektar Pacer patch"),null;if(127!==t[a+3])return console.warn("invalid byte after manufacturer id: ".concat(t[a+3])),null;var r=te(t.slice(a,o));r&&Z(n,r)}return n}n(40);var ae=function(e){var t=e.name,n=e.id,a=e.selected,o=e.onClick;return c.a.createElement("div",{className:a?"selected":"",onClick:function(){return o(n)}},c.a.createElement("div",{className:"name"},t))},oe=function(e){var t=e.currentControl,n=e.onClick;return c.a.createElement("div",{className:"controls"},x.map(function(e){return c.a.createElement(ae,{key:e,name:I[e],id:e,selected:e===t,onClick:n})}),A.map(function(e){return c.a.createElement(ae,{key:e,name:I[e],id:e,selected:e===t,onClick:n})}),c.a.createElement("div",{className:"empty"},"\xa0"),w.map(function(e){return c.a.createElement(ae,{key:e,name:I[e],id:e,selected:e===t,onClick:n})}),c.a.createElement("div",{className:"empty"},"\xa0"),M.map(function(e){return c.a.createElement(ae,{key:e,name:I[e],id:e,selected:e===t,onClick:n})}))},re=(n(42),n(12)),ce=(n(19),n(22)),se=function(e){return null===e.midis?null:c.a.createElement("div",null)},le=function(e){var t=e.obj,n=e.config;return null===n||void 0===n?null:c.a.createElement("div",{className:"dump-control"},c.a.createElement("table",null,c.a.createElement("tbody",null,c.a.createElement("tr",null,c.a.createElement("td",{colSpan:7,className:"name"},I[t])),Object.keys(n.steps).map(function(e){return c.a.createElement("tr",{key:"".concat(t,".").concat(e)},c.a.createElement("td",null,"step ",e),c.a.createElement("td",null,"ch. ",H(n.steps[e].channel)),c.a.createElement("td",null,"msg ",H(n.steps[e].msg_type)),c.a.createElement("td",null,T[n.steps[e].msg_type]),c.a.createElement("td",null,z(n.steps[e].data)),c.a.createElement("td",null,67===n.steps[e].msg_type?ce.a(n.steps[e].data[0],!0):"  "),c.a.createElement("td",null,"active ",n.steps[e].active))}))))},ie=function(e){var t=e.controls;return null===t||void 0===t?null:c.a.createElement("div",{className:"dump-controls"},Object.keys(t).map(function(e){return c.a.createElement(le,{key:e,obj:e,config:t[e]})}))},ue=function(e){var t=e.index,n=e.data;return null===n||void 0===n?null:c.a.createElement("div",null,c.a.createElement("h2",null,"Preset #",t," ",S(parseInt(t,10))),c.a.createElement(ie,{controls:n.controls}),c.a.createElement(se,{controls:n.controls}))},pe=function(e){var t=e.presets;return null===t||void 0===t?null:c.a.createElement("div",null,Object.keys(t).map(function(e){return c.a.createElement(ue,{key:e,index:e,data:t[e]})}))},de=function(e){var t=e.data;return c.a.createElement("div",{className:"dump code"},t&&c.a.createElement(pe,{presets:t[1]}))},me=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(p.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(o)))).state={output:null,presetIndex:"",controlId:"",message:null,data:null},n.selectPreset=function(e){n.setState({presetIndex:e})},n.selectControl=function(e){console.log("selectControl ".concat(e));var t=P(n.state.presetIndex,e);n.sendSysex(t),n.setState({controlId:e,message:t})},n.handleMidiInputEvent=function(e){console.log("Home.handleMidiInputEvent",e,e.data),ee(e.data)?n.setState(Object(re.a)(function(t){t.data=Z(t.data||{},ne(e.data))})):console.log("MIDI message is not a sysex message")},n.sendSysex=function(e){console.log("sendSysex",e),n.state.output&&n.setState({data:null},function(){return F(n.state.output).sendSysex(C,e)})},n.enablePort=function(e){console.warn("SendTester.componentDidMount.enablePort ".concat(e)),n.setState({output:e})},n}return Object(m.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.state,t=e.presetIndex,n=e.controlId,a=e.message,o=e.data;return c.a.createElement("div",null,c.a.createElement("h2",null,"1. Enable the input and output MIDI ports used with your Pacer:"),c.a.createElement("div",{className:"sub-header"},this.props.inputPorts&&c.a.createElement(W,{ports:this.props.inputPorts,type:"input",onMidiEvent:this.handleMidiInputEvent}),this.props.outputPorts&&c.a.createElement(W,{ports:this.props.outputPorts,type:"output",onPortSelection:this.enablePort})),c.a.createElement("div",{className:"main"},c.a.createElement("div",null,c.a.createElement("h2",null,"2. Choose the preset and the control to view/edit:"),c.a.createElement(R,{currentPreset:t,onClick:this.selectPreset}),t&&c.a.createElement(oe,{currentControl:n,onClick:this.selectControl})),t&&n&&c.a.createElement("div",null,c.a.createElement("div",null,c.a.createElement("h3",null,"preset ",S(t),", control ",I[n])),c.a.createElement("div",null,"sysex message to request config: ",c.a.createElement("span",{className:"code"},z(a)))),c.a.createElement("div",null,c.a.createElement("h2",null,"Response:"),c.a.createElement("div",{className:"message code"},c.a.createElement(de,{data:o})))))}}]),t}(r.Component),fe=n(13),Ee=n.n(fe),he=n(17),ve=n(25),be=(n(50),function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(p.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(o)))).state={data:null},n.handleMidiInputEvent=function(e){console.log("Dumper.handleMidiInputEvent",e,e.data),ee(e.data)?(console.log("Dumper.handleMidiInputEvent: data is SysEx"),n.setState(Object(re.a)(function(t){t.data=Z(t.data||{},ne(e.data))}))):console.log("MIDI message is not a sysex message")},n.onDrop=function(e){console.log("drop",e),n.props.onBusy(!0),n.readFiles(e)},n}return Object(m.a)(t,e),Object(u.a)(t,[{key:"readFiles",value:function(){var e=Object(he.a)(Ee.a.mark(function e(t){var n=this;return Ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(t.map(function(){var e=Object(he.a)(Ee.a.mark(function e(t){var a;return Ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.size>5242880)){e.next=4;break}console.warn("".concat(t.name,": file too big, ").concat(t.size)),e.next=8;break;case 4:return e.next=6,new Response(t).arrayBuffer();case 6:ee(a=e.sent)&&n.setState(Object(re.a)(function(e){e.data=Z(e.data||{},ne(a)),n.props.onBusy(!1)}));case 8:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()));case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state.data;return console.log("dumper.render",this.props),c.a.createElement("div",null,c.a.createElement("div",{className:"sub-header"},this.props.inputPorts&&c.a.createElement(W,{ports:this.props.inputPorts,type:"input",onMidiEvent:this.handleMidiInputEvent})),c.a.createElement("div",{className:"main"},c.a.createElement(ve.a,{onDrop:this.onDrop,className:"drop-zone"},"Drop a binary sysex file here or click to open the file dialog"),c.a.createElement(de,{data:e})))}}]),t}(r.Component)),ge=(n(52),function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(p.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(o)))).state={output:null,data:null,messages:[function(e){var t=[2,1,e],n=N(t);return t.push(n),j.concat(t)}(5),P(5,13)]},n.handleMidiInputEvent=function(e){console.log("TestSender.handleMidiInputEvent",e,e.data),ee(e.data)?(console.log("TestSender.handleMidiInputEvent: update state"),n.setState(Object(re.a)(function(t){t.data=Z(t.data||{},ne(e.data))}))):console.log("MIDI message is not a sysex message")},n.enablePort=function(e){console.warn("SendTester.componentDidMount.enablePort ".concat(e)),n.setState({output:e})},n.sendSysex=function(e){console.log("sendSysex",e),n.state.output&&n.setState({data:null},function(){return F(n.state.output).sendSysex(C,e)})},n.sendMessage=function(e){n.sendSysex(e)},n}return Object(m.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this;console.log("SendTester.render",this.props);var t=this.state,n=t.data,a=t.messages;return c.a.createElement("div",null,c.a.createElement("div",{className:"sub-header"},this.props.inputPorts&&c.a.createElement(W,{ports:this.props.inputPorts,type:"input",onMidiEvent:this.handleMidiInputEvent}),this.props.outputPorts&&c.a.createElement(W,{ports:this.props.outputPorts,type:"output",onPortSelection:this.enablePort})),c.a.createElement("div",{className:"main"},c.a.createElement("h2",null,"Messages:"),c.a.createElement("div",null,a.map(function(t,n){return c.a.createElement("div",{key:n,className:"send-message"},c.a.createElement("button",{onClick:function(){return e.sendMessage(t)}},"send")," ",c.a.createElement("span",{className:"code"},z(t)))})),c.a.createElement("h2",null,"Response:"),c.a.createElement("div",{className:"message code"},JSON.stringify(n),c.a.createElement(de,{data:n}))))}}]),t}(r.Component)),ye=function(e){var t=e.label,n=e.to,a=e.activeOnlyWhenExact;return c.a.createElement(v.a,{path:n,exact:a,children:function(e){var a=e.match;return c.a.createElement("span",{className:a?"header-link active":"header-link"},c.a.createElement(b.a,{to:n},t))}})},Oe=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(p.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(o)))).state={inputs:[],outputs:[],busy:!1},n.onInputChange=function(){n.setState({inputs:f.inputs})},n.onOutputChange=function(){n.setState({outputs:f.outputs})},n.onBusy=function(e){n.setState({busy:e})},n}return Object(m.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this,t=this.state,n=t.inputs,a=t.outputs,o=t.busy;return c.a.createElement(g.a,null,c.a.createElement("div",{className:"app"},c.a.createElement(h,{onInputChange:this.onInputChange,onOutputChange:this.onOutputChange}),c.a.createElement("header",{className:"header"},c.a.createElement(ye,{activeOnlyWhenExact:!0,to:"/",label:"Home"}),c.a.createElement(ye,{to:"/dumper",label:"Dumper"}),c.a.createElement(ye,{to:"/testsender",label:"TestSender"}),c.a.createElement("div",{className:"spacer"}),o&&c.a.createElement("div",{className:"busy"},"busy")),c.a.createElement("div",{className:"content"},c.a.createElement(y.a,null,c.a.createElement(v.a,{exact:!0,path:"/",render:function(t){return c.a.createElement(me,{inputPorts:n,outputPorts:a,onBusy:e.onBusy})}}),c.a.createElement(v.a,{path:"/dumper",render:function(t){return c.a.createElement(be,{inputPorts:n,onBusy:e.onBusy})}}),c.a.createElement(v.a,{path:"/testsender",render:function(t){return c.a.createElement(ge,{inputPorts:n,outputPorts:a,onBusy:e.onBusy})}})))))}}]),t}(r.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Ce(){}console.log=Ce,console.warn=Ce,console.error=Ce,l.a.render(c.a.createElement(Oe,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[26,2,1]]]);
//# sourceMappingURL=main.c76bd17a.chunk.js.map